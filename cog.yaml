# Reference: https://github.com/replicate/cog/blob/main/docs/yaml.md

build:
  gpu: true
  python_version: "3.8"
  python_requirements: "requirements.txt"
  system_packages:
    - "libgl1-mesa-glx"
    - "libglib2.0-0"
    - "libsm6"
    - "libxext6"
    - "git"
    - "build-essential"
    - "python3-dev"
    - "libc-bin"


  python_packages:
    - "spacy"
  

    run:
    - "python -m spacy download en_core_web_sm"
    - "git clone https://github.com/NVIDIA/apex && cd apex && pip install -v --disable-pip-version-check --no-cache-dir --no-build-isolation --config-settings=\"--build-option=--cpp_ext\" --config-settings=\"--build-option=--cuda_ext\" ./ && cd ../basic_demo"
    - "sudo ldconfig"
    - "export PATH=$PATH:/sbin"    


predict: "predict.py:Predictor"
